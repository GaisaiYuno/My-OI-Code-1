#include <iostream>
#include <cstdio>
#include <string>
#include <algorithm>
#include <cstring>
using namespace std;
int m,n,now,ans=327689;
int a[111][111];
bool b[111][111],t=0;
int jisuan(int x,int y,bool c)
{
	if (now>ans)return 0;
	else
	if(x==m&&y==m)
	{
		if(now<ans)ans=now;
	}
	else 
	{
		if(b[x-1][y]==0)
		{
			if(a[x-1][y]==0)
			{
				if(c)
				{
					now+=2;
					a[x-1][y]=1;
					if(a[x-1][y]==a[x][y])
					{
						c=0;
						b[x-1][y]=1;
						jisuan(x-1,y,c);
						b[x-1][y]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x-1][y]=1;
						jisuan(x-1,y,c);
						b[x-1][y]=0;
						c=1;
						now-=1;
					}
					a[x-1][y]=2;
					if(a[x-1][y]==a[x][y])
					{
						c=0;
						b[x-1][y]=1;
						jisuan(x-1,y,c);
						b[x-1][y]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x-1][y]=1;
						jisuan(x-1,y,c);
						b[x-1][y]=0;
						c=1;
						now-=1;
					}
					a[x-1][y]=0;
					now-=2;
				}
			}
			else
			{
				if(a[x-1][y]==a[x][y])
					{
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x-1][y]=1;
						jisuan(x-1,y,c);
						b[x-1][y]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						
					}
					else 
					{
						now+=1;
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x-1][y]=1;
						jisuan(x-1,y,c);
						b[x-1][y]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						now-=1;
					}
			}
		}
		if(b[x+1][y]==0)
		{
			if(a[x+1][y]==0)
			{
				if(c)
				{
					now+=2;
					a[x+1][y]=1;
					if(a[x+1][y]==a[x][y])
					{
						c=0;
						b[x+1][y]=1;
						jisuan(x+1,y,c);
						b[x+1][y]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x+1][y]=1;
						jisuan(x+1,y,c);
						b[x+1][y]=0;
						c=1;
						now-=1;
					}
					a[x+1][y]=2;
					if(a[x+1][y]==a[x][y])
					{
						c=0;
						b[x+1][y]=1;
						jisuan(x+1,y,c);
						b[x+1][y]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x+1][y]=1;
						jisuan(x+1,y,c);
						b[x+1][y]=0;
						c=1;
						now-=1;
					}
					now-=2;
					a[x+1][y]=0;
				}
			}
			else
			{
				if(a[x+1][y]==a[x][y])
					{
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x+1][y]=1;
						jisuan(x+1,y,c);
						b[x+1][y]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						
					}
					else 
					{
						now+=1;
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x+1][y]=1;
						jisuan(x+1,y,c);
						b[x+1][y]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						now-=1;
					}
			}
		}
		if(b[x][y-1]==0)
		{
			if(a[x][y-1]==0)
			{
				if(c)
				{
					now+=2;
					a[x][y-1]=1;
					if(a[x][y-1]==a[x][y])
					{
						c=0;
						b[x][y-1]=1;
						jisuan(x,y-1,c);
						b[x][y-1]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x][y-1]=1;
						jisuan(x,y-1,c);
						b[x][y-1]=0;
						c=1;
						now-=1;
					}
					a[x][y-1]=2;
					if(a[x][y-1]==a[x][y])
					{
						c=0;
						b[x][y-1]=1;
						jisuan(x,y-1,c);
						b[x][y-1]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x][y-1]=1;
						jisuan(x,y-1,c);
						b[x][y-1]=0;
						c=1;
						now-=1;
					}
					now-=2;
					a[x][y-1]=0;
				}
			}
			else
			{
				if(a[x][y-1]==a[x][y])
					{
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x][y-1]=1;
						jisuan(x,y-1,c);
						b[x][y-1]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						
					}
					else 
					{
						now+=1;
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x][y-1]=1;
						jisuan(x,y-1,c);
						b[x][y-1]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						now-=1;
					}
			}
		}
		if(b[x][y+1]==0)
		{
			if(a[x][y+1]==0)
			{
				if(c)
				{
					now+=2;
					a[x][y+1]=1;
					if(a[x][y+1]==a[x][y])
					{
						c=0;
						b[x][y+1]=1;
						jisuan(x,y+1,c);
						b[x][y+1]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x][y+1]=1;
						jisuan(x,y+1,c);
						b[x][y+1]=0;
						c=1;
						now-=1;
					}
					a[x][y+1]=2;
					if(a[x][y+1]==a[x][y])
					{
						c=0;
						b[x][y+1]=1;
						jisuan(x,y+1,c);
						b[x][y+1]=0;
						c=1;
					}
					else 
					{
						now+=1;
						c=0;
						b[x][y+1]=1;
						jisuan(x,y+1,c);
						b[x][y+1]=0;
						c=1;
						now-=1;
					}
					now-=2;
					a[x][y+1]=0;
				}
			}
			else
			{
				if(a[x][y+1]==a[x][y])
					{
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x][y+1]=1;
						jisuan(x,y+1,c);
						b[x][y+1]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						
					}
					else 
					{
						now+=1;
						if(!c)
						{
							c=1;
							t=1;
						}
						b[x][y+1]=1;
						jisuan(x,y+1,c);
						b[x][y+1]=0;
						if(t)
						{
							c=0;
							t=0;
						}
						now-=1;
					}
			}
		}
	}
}
int main()
{
	freopen("chess.in","r",stdin);
	freopen("chess.out","w",stdout);
	scanf("%d %d",&m,&n);
	memset(b,0,sizeof(b));
	for (int i=0;i<=m;i++)
	{
		b[0][i]=1;
		b[m+1][i]=1;
		b[i][0]=1;
		b[i][m+1]=1;
	}
	b[m+1][m+1]=1;
	for (int i=1;i<=n;i++)
	{
		int x,y;
		cin>>x>>y;
		cin>>a[x][y];
		a[x][y]++;
	}
	b[1][1]=1;
	jisuan(1,1,1);
	if(ans!=327689)
	printf("%d",ans);
	else printf("-1");
}
