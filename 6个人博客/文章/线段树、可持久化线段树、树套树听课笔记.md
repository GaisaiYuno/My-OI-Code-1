## 线段树、可持久化线段树、树套树听课笔记

### 线段树

#### 存储方式问题

区间$[1,n]$的线段树有$2n-1$个节点

如果是动态开点，$2n-1$个节点就够了(可以用手写内存池)

如果是堆是存储，虽然一般开$4n$，但是实际上开$2^{ceil(\log_2n)+1}$就够了,比如n=10^5,开262144个节点

#### 动态开点的细节

如果没有初始值，最好从根开一条链并计算初始值。比如乘法的话要初始化为1



#### 可持久化线段树

定义:

1. 部分可持久化:允许访问旧版本，但只能修改最新版本
2. 完全可持久化:任意版本都能查询、修改(如函数式线段树能实现线段树的完全可持久化)
3. 汇合可持久化:在完全可持久化的基础上支持合并